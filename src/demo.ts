import { emitUIInteraction } from './liaison/emitter'
import { createPlayer } from './player/web-component'

const player = createPlayer()

const app = document.querySelector<HTMLDivElement>('#app')!

const fly = () => {
  setTimeout(() => {
    const Data = {
      ArmLength: 182103.671875,
      Duration: 3,
      Location: [-150933.81522, -23069.396282, 25299.628117],
      Rotation: [0, -25.206932, -68.69767],
    }
    emitUIInteraction({ Command: 'FlyTo', Data })
  }, 1000 * 3)
}

const render = async (evt: CustomEvent<unknown>) => {
  console.log('connect ===> ', evt.detail)

  fly()
}

const log = (evt: CustomEvent<unknown>) => {
  console.log('text ===> ', evt.detail)
}

player.setAttribute('application-name', 'HdecUnrealPinglu')
// player.setAttribute('aspect-ratio', 'auto')
player.setAttribute('aspect-ratio', '23 / 9')
// player.toggleAttribute('debug-panel', false)
// player.toggleAttribute('fill-window', true)
player.id = 'cve-demo'
player.setAttribute('level-name', 'Madao')
// player.toggleAttribute('match-viewport', false)
player.setAttribute('scene-name', 'Base')
player.toggleAttribute('use-mic', false)
player.setAttribute('volume', '0.3')

player.addEventListener('connect', render)
player.addEventListener('text', log)

app.appendChild(player)
