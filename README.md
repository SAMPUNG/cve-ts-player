# CVE Player

This tool should help get you started developing with Pixel Streaming in UE5.

Visit demo project to get more details:

[@cve-ts/demo (github)](https://github.com/SAMPUNG/cve-ts-demo)

## Usage

### Installation

- npm

```cmd
npm install @cve-ts/player
```

- yarn

```cmd
yarn add @cve-ts/player
```

### Integrate into page

```html
<!-- HTML Template -->
<cve-player
  application-name="HdecUnrealHaining"
  origin="http://localhost"
>
</cve-player>

<script type="module">
// Must import player when use it
import { player } from '@/player/custom-element'

player?.addEventListener('connect', (evt) => {
  console.warn('connect ===> ', evt.detail)
})
player?.addEventListener('reject', (evt) => {
  console.error('reject ===> ', evt.detail)
})
</script>
```

## Attributes

```html
<cve-player
  application-name="HdecUnrealPinglu"
  aspect-ratio="auto"
  level-name="Madao"
  origin="http://39.170.3.124:80/"
  scene-name="Base"
  volume="0.3"
>
</cve-player>
```

### application-name

- Required

- UE application name

- No default value

### aspect-ratio

- Optional

- Aspect ratio for resize

- Examples: 'auto',Â '16 / 9', '4 / 3'

- Default value: 'auto'

### level-name

- Optional

- UE Level Name

- No default value

### origin

- Optional

- Pixel Streaming Service Origin

- Default value: 'http://localhost:80'

### scene-name

- Optional

- UE Scene Name

- No default value

### volume

- Optional

- Volume of player

- Default value: 0.3

## Web Component

```ts
export class CvePlayer extends HTMLELment {
  onconnect?: (evt: CustomEvent<number>) => void
  ondebug?: (evt: CustomEvent<unknown>) => void
  ondisconnect?: (evt: CustomEvent<string>) => void
  oninit?: (evt: CustomEvent<unknown>) => void
  onmeasure?: (evt: CustomEvent<unknown>) => void
  onpick?: (evt: CustomEvent<unknown>) => void
  onreject?: (evt: CustomEvent<string>) => void
  onrender?: (evt: CustomEvent<unknown>) => void
}
export let player: CvePlayer | undefined
```

## Events

### connect

```ts
import { player } from '@cve-ts/player'

// Cloud Render Connected
player?.onconnect = (evt) => {
  const timestamp: number = evt.detail
  console.warn('connect ===> ', timestamp)
}
```

### disconnect

```ts
import { player } from '@cve-ts/player'

// Cloud Render Disconnected
player?.ondisconnect = (evt) => {
  const error: unknown = evt.detail
  console.log('disconnect ===> ', error)
}
```

### init

```ts
import { player } from '@cve-ts/player'

// UE Scene Initialized
player?.oninit = (evt) => {
  const data: unknown = evt.detail
  console.error('init ===> ', data)
}
```

### measure

```ts
import { player } from '@cve-ts/player'

// UE Measure Finished Action
player?.onmeasure = (evt) => {
  const data: unknown = evt.detail
  console.error('measure ===> ', data)
}
```

### pick

```ts
import { player } from '@cve-ts/player'

// UE Feature Selected Action
player?.onpick = (evt) => {
  const data: unknown = evt.detail
  console.error('pick ===> ', data)
}
```

### reject

```ts
import { player } from '@cve-ts/player'

// Request Pixel Streaming Failed
player?.onreject = (evt) => {
  const reason: string = evt.detail
  console.error('reject ===> ', reason)
}
```

### render

```ts
import { player } from '@cve-ts/player'

// UE Cloud Render Action
player?.onrender = (evt) => {
  const jsonData: unknown = evt.detail
  console.log('render ===> ', jsonData)
}
```

## Play Controls

### open

```ts
import { open } from '@cve-ts/player'
// Open level with LevelName and SceneName
open('Madao', 'Base')
// Open level with `level-name` and `scene-name` attributes
open()
```

### resize

```ts
import { resize } from '@cve-ts/player'
// Resize window with `aspect-ratio` attribute
resize()
```

### run

```ts
import { run } from '@cve-ts/player'
// Run player with `application-name ` and `origin` attributes
run()
```

### start

```ts
import { start } from '@cve-ts/player'
// Start render with url
start('http://localhost:8081')
```

### stop

```ts
import { stop } from '@cve-ts/player'
// Stop render
stop()
```

## CVE Plugins

### Controls

Here some controls we could use.

[@cve-ts/controls - npm (npmjs.com)](https://www.npmjs.com/package/@cve-ts/controls)

### Geometry Features

Here some geometry features we could use.

[@cve-ts/features - npm (npmjs.com)](https://www.npmjs.com/package/@cve-ts/features)
